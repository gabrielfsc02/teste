import{j as e,x as A,I as j,bj as P,_ as T,b7 as E,F as b,H as D,K as _}from"./v_7_3_4_7_6e7deaa1-1876-4289-adc9-5c3b896aa7ed10.js";import{a as f}from"./v_7_3_4_7_6e7deaa1-1876-4289-adc9-5c3b896aa7ed4.js";import{n as I,o as k}from"./v_7_3_4_7_6e7deaa1-1876-4289-adc9-5c3b896aa7ed22.js";import{u as y}from"./v_7_3_4_7_6e7deaa1-1876-4289-adc9-5c3b896aa7ed19.js";import{W as L,V as R}from"./v_7_3_4_7_6e7deaa1-1876-4289-adc9-5c3b896aa7ed18.js";import{c as z}from"./v_7_3_4_7_6e7deaa1-1876-4289-adc9-5c3b896aa7ed7.js";import{C as U}from"./v_7_3_4_7_6e7deaa1-1876-4289-adc9-5c3b896aa7ed112.js";import"./v_7_3_4_7_6e7deaa1-1876-4289-adc9-5c3b896aa7ed8.js";import"./v_7_3_4_7_6e7deaa1-1876-4289-adc9-5c3b896aa7ed.js";import"./v_7_3_4_7_6e7deaa1-1876-4289-adc9-5c3b896aa7ed5.js";import"./v_7_3_4_7_6e7deaa1-1876-4289-adc9-5c3b896aa7ed6.js";import"./v_7_3_4_7_6e7deaa1-1876-4289-adc9-5c3b896aa7ed2.js";import"./v_7_3_4_7_6e7deaa1-1876-4289-adc9-5c3b896aa7ed3.js";import"./v_7_3_4_7_6e7deaa1-1876-4289-adc9-5c3b896aa7ed9.js";function F({colunas:l,resolve:s}){const{close:r}=I(),c=()=>{s(!1)};f.useEffect(()=>c,[]);const{language:o}=y(),d=a=>{s(a),r()};return e.jsxs("div",{className:"max-w-[80vw] max-h-[80vh] min-h-[305px]",children:[e.jsx(A,{children:o.colunaComNumeros}),e.jsxs("span",{className:"text-lg text-[var(--primary)]",children:[o.naoFoiPossivelColunaComNumeros,",",e.jsx("strong",{children:o.numbers}),",",o.selecioneManualmenteAColuna]}),e.jsx("div",{className:"p-4 flex flex-wrap gap-4 max-h-[80vh] overflow-y-auto",children:Object.values(l).map(a=>{if(a[0]!==void 0)return e.jsxs("div",{className:"shadow-sm w-fit hover:border-[var(--primaria)] hover:border hover:border-solid pulse cursor-pointer rounded-lg max-w-80",onClick:()=>d(a),children:[e.jsx("div",{className:"bg-[var(--primaria)] text-[var(--letra)] text-center rounded-t-lg font-bold p-1 whitespace-nowrap text-ellipsis overflow-hidden",children:a[0]}),e.jsx("div",{className:"flex flex-col bg-base-200 p-1 rounded-b-lg max-h-[300px] overflow-y-auto gap-1",children:a.slice(1,10).map((x,m)=>e.jsx("span",{className:"whitespace-nowrap text-ellipsis overflow-hidden",children:x}))})]})})})]})}function B(){const{loading:l}=w(),{language:s}=y();return e.jsxs("div",{className:"flex flex-col justify-center gap-4 w-[320px] items-center",children:[e.jsx("div",{className:"radial-progress text-[var(--primaria)] text-center",id:"progress",style:{"--value":l.porcentagem,"--size":"12rem","--thickness":"6px"},children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"pulse",children:[l.porcentagem,"%"]}),e.jsx("span",{className:"pulse",children:l.contador})]})}),e.jsxs("div",{className:"loading-animate animate__animated animate__jackInTheBox",children:[e.jsx("div",{className:"loading-name p-1",children:s.aguarde}),e.jsx("div",{className:"circle"}),e.jsx("div",{className:"circle"}),e.jsx("div",{className:"circle"})]})]})}const w=z()(l=>({file:null,options:{internacional:!1,ninthDigit:!1,validar:!1},loading:{porcentagem:"0%",contador:"0"},updateOptions:(s,r,c)=>l(o=>({options:{...o.options,[c]:!1,[s]:r}})),atualizarOptions:(s,r)=>l(c=>({options:{...c.options,[s]:r}})),setFile:s=>l({file:s}),extrairColunas:()=>new Promise((s,r)=>{const{file:c}=w.getState(),o=new FileReader;o.onload=async d=>{var a;const p=(a=d.target)==null?void 0:a.result;if(p){const x=new Uint8Array(p).reduce((m,u)=>m+String.fromCharCode(u),"");try{const m=await fetch(`${R.backend_utils}api/XLSX/processPlanilha`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:btoa(x)})});if(!m.ok){r("Erro ao processar a planilha no servidor");return}const u=await m.json();s(u.colunas)}catch{r("Erro ao processar a planilha no servidor")}}},o.readAsArrayBuffer(c)}),capturarContatos:async()=>{const{extrairColunas:s,options:r,updateLoading:c}=w.getState(),{open:o,close:d}=I.getState(),{language:p}=y.getState();let a=await s();const x=[],m=["NUMEROS","NUMERO","NÚMERO","NÚMEROS","PHONE","PHONES","WHATSAPP"];let u=Object.values(a).filter((t,i)=>{if(t[0]&&m.includes(t[0].toString().toUpperCase().replaceAll(" ","")))return t});const C=["NOMES","NOME","NAMES","NAME"],g=Object.values(a).filter((t,i)=>{if(t[0]&&C.includes(t[0].toString().toUpperCase().replaceAll(" ","")))return t});if(u.length===0){j({type:"Info",message:p.planilhaNaoTemColunaNumeros,position:"top-right"});const t=await new Promise((i,n)=>{o(e.jsx(F,{colunas:a,resolve:i}))});if(!t){j({type:"Error",message:p.colunaComNumerosNaoSelecionada,position:"top-right"});return}u=[t]}r.validar&&o(e.jsx(B,{}));for(let[t,i]of Object.entries(u[0])){let n=i;if(c(u[0].length-1,parseInt(t)),n=n.toString().replace(/\D/g,""),!(n.length<8||n.length>17)){if(r.internacional||(n=P.add55(n),r.ninthDigit||(n=P.add9(n))),r.validar&&await L.Contact("queryExists",n)!=="undefined"){let v={id:n.toString(),name:g.length!==0?g[0][parseInt(t)]:n};Object.values(a).filter((h,M)=>{let O=h[parseInt(t)];h[parseInt(t)]!==void 0&&(v[h[0]]=O.toString())}),x.push(v)}else if(!r.validar){let v={id:n.toString(),name:g.length!==0?g[0][parseInt(t)]:n,imported:!0};Object.values(a).filter((h,M)=>{let O=h[parseInt(t)];h[parseInt(t)]!==void 0&&(v[h[0]]=O.toString())}),x.push(v)}}}let N={},S=x.filter(t=>N[t.id]?!1:(N[t.id]=!0,!0));return j({type:"Success",message:p.contatosImportados,position:"top-right"}),d(),l({file:null}),S},updateLoading:(s,r)=>l(()=>({loading:{porcentagem:(r*100/s).toFixed(0).toString(),contador:`${s} / ${r}`}}))})),V=f.lazy(() => __vitePreload(()=>import(chrome.runtime.getURL("content/assets/js/v_7_3_4_7_6e7deaa1-1876-4289-adc9-5c3b896aa7ed197.js")),[]));function q(){return e.jsx(f.Suspense,{fallback:e.jsx(e.Fragment,{}),children:e.jsx(V,{})})}function se({list:l}){const{open:s}=k(),{file:r,setFile:c,capturarContatos:o,options:d,updateOptions:p}=w(),{language:a,idioma:x}=y(),[m,u]=f.useState(!1);f.useRef(null),f.useRef(null);const C=i=>{s(e.jsx(q,{}),{placement:"top"},i)},g=i=>{i.preventDefault();const n=i.dataTransfer.files[0];n&&n.type.startsWith("application/")?c(n):j({type:"Error",message:a.carregueUmArquivoDoTipo,position:"top-right"})},N=i=>{i.preventDefault()},S=async()=>{if(u(!0),!r){j({type:"Error",message:a.porFavorCarregueUmArquivo,position:"top-right"});return}const i=await o();l(i??[])};return e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{children:a.importarPlanilhas}),e.jsx("span",{className:"pulse cursor-pointer lg:tooltip lg:tooltip-bottom","data-tip":a.asColunasDevemConter,children:e.jsx(E,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"flex flex-col w-[555px]",children:[e.jsx(b,{weight:"600",children:a.importeOuArrastePlanilha}),e.jsxs(b,{children:[a.vocePodeBaixarUm,e.jsxs("strong",{className:"text-[var(--primaria)] pulse cursor-pointer",children:[" ",a.model," "]}),a.paraTalDocumento,e.jsx("button",{className:"ml-3 btn-daisy !btn-xs !bg-[var(--primaria)] pulse !text-[var(--letra)]",onClick:i=>C(i.target),children:a.visualizarModelo})]})]}),e.jsxs("div",{className:"flex gap-2 items-center justify-center h-24 w-full",children:[e.jsxs("label",{className:"p-2 border-base-200 hover:border-[var(--primaria)] border border-solid rounded-lg h-full w-20 pulse flex justify-center items-center flex-col shadow-lg cursor-pointer",children:[e.jsx(U,{className:"h-6 w-6 text-[var(--primaria)]",strokeWidth:1}),e.jsx("strong",{className:"text-[var(--primaria)]",children:a.import}),e.jsx("input",{type:"file",accept:".xlsx, .csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, text/csv",className:"hidden",onChange:i=>c(i.target.files[0])})]}),e.jsx("div",{className:"border-dashed border-2 border-[var(--primaria)] rounded-lg h-full w-full flex justify-center items-center",onDrop:g,onDragOver:N,children:a.arrasteOArquivoAqui})]}),r&&r.name&&e.jsx("div",{className:"text-center",children:e.jsx(b,{children:e.jsx("strong",{className:"text-[var(--primaria)]",children:r.name})})}),e.jsxs("div",{className:"pt-3",children:[e.jsx(b,{weight:"600",children:a.DefinaAsConfiguracoesImportacao}),e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex justify-between cursor-pointer items-center hover:bg-[var(--dropdown-background-hover)] h-9 px-1 py-2 rounded",children:[e.jsxs("span",{children:[a.aPlanilhaContemNumeros," ",e.jsx("strong",{children:a.internacionais}),"?"]}),e.jsx(D,{estado:d.internacional,switchUpdate:()=>p("internacional",!d.internacional,"ninthDigit"),id:"internacional"})]}),x==="pt"&&e.jsxs("div",{className:"flex justify-between cursor-pointer items-center hover:bg-[var(--dropdown-background-hover)] h-9 px-1 py-2 rounded",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("span",{children:[a.ignorarValidacaoDo,e.jsx("strong",{children:a.digitoBrasileiro}),"?"]}),e.jsx("span",{className:"pulse cursor-pointer lg:tooltip lg:tooltip-top before:!w-48","data-tip":a.dicaDigitoBrasileiro,children:e.jsx(E,{className:"h-5 w-5"})})]}),e.jsx(D,{estado:d.ninthDigit,switchUpdate:()=>p("ninthDigit",!d.ninthDigit,"internacional"),id:"ninthDigit"})]}),e.jsx("div",{className:"text-center pt-3",children:m?e.jsx("span",{className:"loading loading-spinner loading-md text-[var(--primaria)]"}):e.jsx(_,{name:a.realizarImportacao,funcao:S})})]})]})]})}export{se as default};
