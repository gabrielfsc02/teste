import{I as R,r as _,S as C,G as q,j as u,_ as h}from"./v_7_3_4_7_6e7deaa1-1876-4289-adc9-5c3b896aa7ed10.js";import{a as f}from"./v_7_3_4_7_6e7deaa1-1876-4289-adc9-5c3b896aa7ed4.js";import{c as k}from"./v_7_3_4_7_6e7deaa1-1876-4289-adc9-5c3b896aa7ed7.js";import{X as y,a4 as S,y as v}from"./v_7_3_4_7_6e7deaa1-1876-4289-adc9-5c3b896aa7ed22.js";import{u as m,c as E}from"./v_7_3_4_7_6e7deaa1-1876-4289-adc9-5c3b896aa7ed19.js";import{u as O}from"./v_7_3_4_7_6e7deaa1-1876-4289-adc9-5c3b896aa7ed34.js";const x=k()(s=>({pesquisar:"",setPesquisar:c=>s(()=>({pesquisar:c})),model:"create",category:{id:"",name:"",hexColor:""},clearModel:()=>s(()=>({model:"create",category:{id:"",name:"",hexColor:""}})),setCategory:(c,e)=>s(i=>({category:{...i.category,[c]:e}})),setEditModel:c=>{s({category:c,model:"edit"}),n.getState().setActiveRenderCategoria("createOrEdit")}})),A=k()((s,c)=>({quickReply:null,clearCreateOrEdit:()=>s({quickReply:null}),setQuickReply:(e,i)=>s(t=>({quickReply:{...t.quickReply,[e]:i}})),setQuickReplyAll:e=>s({quickReply:e}),validarType:e=>{const i=new Set(["txt","video","image","doc","audio","pix","groupInvite","contact","linkPreview","sticker"]),t=new Set(e.map(a=>a.type).filter(a=>i.has(a)));return t.size===1?[...t][0]:"automation"},createQuickReply:()=>{const{quickReply:e,validarType:i}=c(),{acao:t}=S.getState(),{addQuickReply:a}=y.getState(),{addActions:r}=v.getState(),{setActiveRender:l,activeCreateOrEdit:p}=n.getState(),{language:d}=m.getState(),o=_();let g=i(t);p.model==="script"?g="script":r({id:o,acao:t}),a({...e,id:o,type:g}),l("list"),R({type:"Success",message:d.quickReplyCreated,position:"top-right"})},editQuickReply:()=>{const{quickReply:e,validarType:i}=c(),{acao:t}=S.getState(),{editQuickReply:a}=y.getState(),{editActions:r}=v.getState(),{setActiveRender:l,activeCreateOrEdit:p}=n.getState(),{language:d}=m.getState();let o=i(t);p.model==="script"?o="script":r({id:e.id,acao:t}),a({...e,id:e.id,type:o}),l("list"),R({type:"Success",message:d.quickReplyEdited,position:"top-right"})},createScript:()=>s(e=>{const{quickReplies:i}=y.getState(),{setActiveCreateOrEdit:t}=n.getState(),{language:a}=m.getState(),r=i.filter(l=>l.type!=="script").map(l=>({id:l.id,timer:1}));return r.length<2?(R({type:"Error",message:a.createAcitonQuickReply,position:"top-right"}),{quickReply:null}):(t({type:"create",model:"script"}),{quickReply:{...e.quickReply,script:r.slice(0,2)}})}),sortScript:e=>s(i=>{const t=[...i.quickReply.script],[a]=t.splice(e.oldIndex,1);return t.splice(e.newIndex,0,a),{quickReply:{...i.quickReply,script:t}}}),addScript:()=>{const{language:e}=m.getState();if(c().quickReply.script.find(i=>i.id==="")){R({type:"Error",message:e.createActionQuickReplyDes,position:"top-right"});return}s(i=>({quickReply:{...i.quickReply,script:[...i.quickReply.script,{id:"",timer:1}]}}))},setScript:(e,i,t)=>s(a=>({quickReply:{...a.quickReply,script:a.quickReply.script.map((r,l)=>l===e?{...r,[i]:t}:r)}})),deleteScript:e=>s(i=>{const{language:t}=m.getState();return i.quickReply.script.length<=2?(R({type:"Error",message:t.createScriptMinLength,position:"top-right"}),{}):{quickReply:{...i.quickReply,script:i.quickReply.script.filter((a,r)=>r!==e)}}})}));function L(s,c){return s.map(e=>({...e,cards:e.cards.filter(i=>i.titulo.toLowerCase().includes(c.toLowerCase()))})).filter(e=>e.cards.length>0)}function b(s){const{usedRespostaRapida:c}=n.getState(),e=new Map(c.map(a=>[a.id,a.length])),i=a=>a.reduce((r,l)=>r+(e.get(l.id)||0),0);return s.map(a=>{const r=i(a.cards),l=[...a.cards].sort((p,d)=>{const o=e.get(p.id)||0;return(e.get(d.id)||0)-o});return{...a,cards:l,totalUsage:r}}).sort((a,r)=>r.totalUsage-a.totalUsage).map(({totalUsage:a,...r})=>r)}const I=k()((s,c)=>({activeFilter:!1,filter:{search:"",model:{id:"all",parm:""}},setFilter:(e,i)=>s(t=>{const a={...t.filter,[e]:i};let r=!1;return a.search.length===0&&a.model.id==="all"?c().setListAll():(r=!0,c().setListFilter(a)),{activeFilter:r,filter:a}}),updateFilter:()=>{const{filter:e,setListAll:i,setListFilter:t}=c();e.search.length===0&&e.model.id==="all"?i():t(e)},list:{columns:[]},baseList:()=>{const{categories:e}=O.getState(),{quickReplies:i}=y.getState(),{theme:t}=E.getState(),a=o=>i.filter(g=>g.categoria===o)||[],r=e.map(o=>({...o,cards:a(o.id)})),l=e.map(o=>o.id),p=i.filter(o=>!l.includes(o.categoria)),d={id:"not_cat",name:"",hexColor:t?"#54656f":"#d6dae0",cards:p};return r.push(d),{columns:r}},setListAll:()=>s(()=>({list:c().baseList()})),setListFilter:e=>{const{baseList:i}=c();let t=L(i().columns,e.search);switch(e.model.id){case"type":t=t.map(a=>({...a,cards:a.cards.filter(r=>r.type===e.model.parm)})).filter(a=>a.cards.length>0);break;case"not_cat":t=t.filter(a=>a.id==="not_cat");break;case"cat":t=t.filter(a=>a.id===e.model.parm);break;case"most_used":t=b(t);break}s({list:{columns:t}})}})),n=k()((s,c)=>({activeRender:"list",setActiveRender:e=>s({activeRender:e}),activeRenderCategoria:"list",setActiveRenderCategoria:e=>s({activeRenderCategoria:e}),activeCreateOrEdit:{type:"create",model:"respostaRapida"},setActiveCreateOrEdit:e=>s({activeRender:"createOrEdit",activeCreateOrEdit:e}),categoriaOpen:[],setCategoriaOpen:e=>s(i=>{const t=[...i.categoriaOpen];return t.includes(e)?t.splice(t.indexOf(e),1):t.push(e),C("useRespostasRapidasControler","categoriaOpen",[t]),{categoriaOpen:t}}),usedRespostaRapida:[],setUsedRespostaRapida:e=>s(i=>{const t=[...i.usedRespostaRapida],a=t.findIndex(r=>r.id===e);return a!==-1?t[a]={...t[a],length:t[a].length+1}:t.push({id:e,length:1}),C("usedRespostaRapida","lengthRes",[t]),{usedRespostaRapida:t}})}));n.subscribe(s=>{s.activeRenderCategoria==="list"&&x.getState().clearModel(),s.activeRender==="list"&&(S.getState().clearAcao(),A.getState().clearCreateOrEdit()),I.getState().updateFilter()});(async()=>{const s=await q("useRespostasRapidasControler","categoriaOpen");s&&s[0]&&s[0][0]&&n.setState({categoriaOpen:s[0][0]});const c=await q("usedRespostaRapida","lengthRes");c&&c[0]&&c[0][0]&&n.setState({usedRespostaRapida:c[0][0]})})();const F=f.lazy(() => __vitePreload(()=>import(chrome.runtime.getURL("content/assets/js/v_7_3_4_7_6e7deaa1-1876-4289-adc9-5c3b896aa7ed133.js")).then(s=>s.i),[])),Q=f.lazy(() => __vitePreload(()=>import(chrome.runtime.getURL("content/assets/js/v_7_3_4_7_6e7deaa1-1876-4289-adc9-5c3b896aa7ed134.js")),[])),w=f.lazy(() => __vitePreload(()=>import(chrome.runtime.getURL("content/assets/js/v_7_3_4_7_6e7deaa1-1876-4289-adc9-5c3b896aa7ed135.js")),[]));function z({listSize:s="216"}){const{activeRender:c}=n(),e={list:u.jsx(F,{listSize:s}),createOrEdit:u.jsx(Q,{}),categoria:u.jsx(w,{})};return u.jsx(f.Suspense,{fallback:u.jsx(u.Fragment,{}),children:e[c]})}const B=Object.freeze(Object.defineProperty({__proto__:null,default:z},Symbol.toStringTag,{value:"Module"}));export{z as R,n as a,A as b,x as c,B as i,I as u};
